\documentclass{article}
\usepackage[utf8]{inputenc}

\usepackage{amsmath,amsthm, amssymb}
\usepackage[margin=1.5cm]{geometry}
\usepackage{mathtools}
\usepackage{dsfont}
\usepackage{xcolor}
\usepackage{algorithm,algpseudocode}
\usepackage{todonotes}
\usepackage{nicefrac}
\usepackage{mathrsfs}
\usepackage{tikz}

%%%%%%%%    THEOREM DEFINITIONS AND RESTATABLE
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}

\usepackage{todonotes}

\newcommand{\matt}[1]{\todo[color=red!50, prepend, caption={Matt}, tickmarkheight=0.25cm]{#1}}
\newcommand{\note}[1]{\emph{Note: #1}}
\newcommand{\conjecture}[1]{ \noindent\emph{\textbf{Conjecture:}} \emph{ #1 }}




%%%%%%%%    NOTATION DEFINITIONS FOR EASIER WRITING
\newcommand{\ket}[1]{|#1\rangle}
\newcommand{\bra}[1]{\langle #1|}
\newcommand{\braket}[2]{\langle #1|#2\rangle}
\newcommand{\ketbra}[2]{| #1\rangle\! \langle #2|}
\newcommand{\parens}[1]{\left( #1 \right)}
\newcommand{\brackets}[1]{\left[ #1 \right]}
\newcommand{\abs}[1]{\left| #1 \right|}
\newcommand{\norm}[1]{\left| \left| #1 \right| \right|}
\newcommand{\diamondnorm}[1]{\left| \left| #1 \right| \right|_\diamond}
\newcommand{\anglebrackets}[1]{\left< #1 \right>}
\newcommand{\overlap}[2]{\anglebrackets{#1 , #2 }}
\newcommand{\set}[1]{\left\{ #1 \right\}}
\newcommand{\ceil}[1]{\left\lceil #1 \right\rceil}
\newcommand{\openone}{\mathds{1}}
\newcommand{\expect}[1]{\mathbb{E}\brackets{#1}}
\newcommand{\prob}[1]{\text{Pr}\left[ #1 \right]}
\newcommand{\bigo}[1]{\mathcal{O}\left( #1 \right)}
\newcommand{\bigotilde}[1]{\widetilde{\mathcal{O}} \left( #1 \right)}
\newcommand{\ts}{\textsuperscript}

\DeclareMathOperator{\Tr}{Tr}
\newcommand{\trace}[1]{\Tr \brackets{ #1 }}
\newcommand{\partrace}[2]{\Tr_{#1} \brackets{ #2 }}
\newcommand{\complex}{\mathbb{C}}

%%%%% COMMONLY USED OBJECTS
\newcommand{\hilb}{\mathcal{H}}
\newcommand{\partfun}{\mathcal{Z}}
\newcommand{\identity}{\mathds{1}}
\newcommand{\gue}{\rm GUE}
\DeclareMathOperator{\hermMathOp}{Herm}
\newcommand{\herm}[1]{\hermMathOp\parens{#1}}


\title{Thermal State Prep}
\author{Nathan Wiebe, Matthew Hagan}
\date{May 2022}

\begin{document}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
Going to leave this blank for now. 

Want to include here the main methods for preparing thermal states that currently exist, mainly the Poulin and Wocjan paper and Quantum-Quantum Metropolis Hastings. Where should more niche/advanced methods go? \cite{shiraishi_undecidability_2021}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Preliminaries}
We denote the Hilbert space of the system as $\hilb_{sys}$ and the environment as $\hilb_{env}$, with the Hamiltonians governing each as $H_{sys}$ and $H_{env}$. The Hamiltonian for the joint system on $\hilb_{sys} \otimes \hilb_{env}$ is then $H = H_{sys} \otimes \identity + \identity \otimes H_{env}$. We study the effects of simulating the time dynamics of the system-environment space with randomized interactions. Our goal is to produce a channel that can reduce the entropy of a system thermal state by utilizing easily prepared thermal states of the environment. We consider using the Haar measure over eigenvectors for the randomized interaction and i.i.d eigenvalues from a zero mean $\sigma^2$ variance distribution. We consider input states of the form $\rho(\beta_S, \beta_E) = \frac{e^{-\beta_S H_{sys}}}{\partfun_{sys}} \otimes \frac{e^{-\beta_E H_{env}}}{\partfun_{env}}$ and will simply use $\rho$ until the thermal nature of our inputs are necessary. The thermal states for the environment are supposed to be easily preparable.

The Hamiltonians $H_{sys}$ and $H_{env}$ form a basis for the tensor product space. As we are not concerned with specific details of the eigenvectors of each, we will refer to them by an arbitrary index. Let $E_{i,j}$ denote the eigenvalue $E_i(H_{sys}) + E_j(H_{env})$ and $\ket{i,j}$ the corresponding eigenvector. Without loss of generality we will focus on spaces in which the system can be represented with $n$ qubits and the environment with $m$ qubits. So we have
\begin{equation}
    H_{sys} = \sum_{i = 0}^{2^n - 1} E_i \ketbra{i}{i} ~,~ H_{env} = \sum_{j=0}^{2^m - 1} E_j \ketbra{j}{j} ~,~ H = \sum_{i=0}^{2^n - 1} \sum_{j=0}^{2^m - 1} E_{i,j} \ketbra{i,j}{i,j}.
\end{equation}
The above is just to put all the chosen notation in a convenient place. 


Overall one application of our channel is represented as
\begin{equation}
    \Phi(\rho) := \int \partrace{env}{e^{+i(H + \alpha G)t} \rho e^{-i(H + \alpha G) t}} dG.
\end{equation}
For simplicity we will denote the time evolution channel for a specific random interaction $G$ as
\begin{equation}
    \Phi_G(\rho) := e^{+i (H+ \alpha G) t} \rho e^{-i (H + \alpha G) t}.
\end{equation}
Clearly then $\Phi = \int \partrace{env}{\Phi_G} dG$. We use $G$ to denote the randomized interaction term, where $G = U_G D U_G^\dagger$. The measure we choose for the eigenbasis of $G$ is $U_G \sim Haar$ and the eigenvalues are i.i.d with mean 0 and variance $\sigma^2$. This gives the overall measure decomposition $dG = dD ~ dU_G$. 

\begin{lemma}
    What is the computation of the Haar integral 
    \begin{equation}
        \int dU \bra{i_1} U \ket{j_1} \bra{i_2} U \ket{j_2} \bra{k_1} \overline{U} \ket{l_1} \bra{k_2} \overline{U} \ket{l_2} = 
    \end{equation}
\end{lemma}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Fixed Points}
Our first goal is to show that $\rho(\beta, \beta)$ is a fixed point, at least approximately, of the channel $\Phi$. We then aim to show that it is an attractor for states of the form $\rho(\beta_S, \beta_E)$ with $\beta_E > \beta_S$. 

\subsection{Computing $\Phi_G$ with Duhamel's formula}
Our first goal is to compute the Taylor's series for $\Phi$ with respect to the coupling constant $\alpha$. To do this we compute the Taylor Series for $\Phi_G$ and then compute the effects of integrating and partial traces. We make use Duhamel's formula for differentiation of the exponent of a matrix exponential
\begin{equation}
    \frac{d}{dt} e^{A(t)} = \int_0^1 e^{s A(t)} \frac{d A(t)}{dt} e^{(1-s)A(t)} ds.
\end{equation}
The object of interest is $$\Phi_G = \rho(t) + \alpha \frac{\partial}{\partial \alpha} \Phi_G \big|_{\alpha=0} + \frac{\alpha^2}{2!} \frac{\partial^2}{\partial \alpha^2} \Phi_G \big|_{\alpha=0} + R.$$ Then due to linearity of integration and partial traces this will give us a series expansion in $\alpha$ for the overall channel $\Phi$. We first focus on computing the first two non-trivial terms and focus on bounding the magnitude of $R$ later. 
The first order term can be computed as
\begin{align}
    \frac{\partial}{\partial \alpha} e^{i(H+\alpha G)t} \rho e^{-i (H+\alpha G)t} \bigg|_{\alpha = 0} &= \int_{0}^{1} e^{i s (H+\alpha G)t} (i t G) e^{i (1-s) (H+\alpha G)t} ds \rho e^{-i(H+\alpha G)t} \bigg|_{\alpha=0} \nonumber \\
    &\text{ } + e^{i(H+\alpha G)t} \rho \int_{0}^1 e^{-i s (H+\alpha G) t} (- i t G) e^{-i (1-s) (H+\alpha G)t} ds \bigg|_{\alpha = 0} \label{eq:first_order_alpha_derivative}\\
    &= i t \int_0^1 e^{i s H t} G e^{-i s H t} ds e^{i H t} \rho e^{-i H t} - i t e^{+i H t} \rho \int_0^1 e^{-is H t} G e^{-i(1-s) Ht} ds \\
    &= i t \int_0^1 G(s t) ds \rho(t) - it \rho(t) \int_0^1 G(s t) ds \\
    &= i t \int_0^1 [G(s t), \rho(t)] ds.
\end{align}

This term is negligible in the overall channel due to the eigenvalues having mean 0. This is computed as
\begin{align}
    \frac{\partial}{\partial \alpha} \Phi(\rho) \bigg|_{\alpha = 0} &= \frac{\partial}{\partial \alpha} \partrace{env}{\int \Phi_G(\rho) ~dG} \bigg|_{\alpha=0} \\
    &= \partrace{env}{\int\frac{\partial \Phi_G(\rho)}{\partial \alpha} \bigg|_{\alpha=0} dG } \\
    &= i t \partrace{env}{\int_0^1 \int [e^{i H s t} G e^{-i H s t}, \rho(t)] dG ds} \\
    &= i t \partrace{env}{\int_0^1  [e^{i H s t} \int U_G D U_G^\dagger ~ dD ~ dU_G e^{-i H s t}, \rho(t)] ds} \\
    &= i t \partrace{env}{\int_0^1  [e^{i H s t} \int U_G \parens{\int D dD} U_G^\dagger ~ dU_G e^{-i H s t}, \rho(t)] ds},
\end{align}
but because $\int D ~dD$ is simply the mean of the eigenvalues this is 0 which implies $\frac{\partial}{\partial \alpha} \Phi(\rho) \big|_{\alpha = 0} = 0$. 

Now we can compute the second order term by differentiating Eq. \eqref{eq:first_order_alpha_derivative} before setting $\alpha \to 0$. Note that there are 3 locations for the derivative to act in each term, yielding 6 final terms. To give a sense of how each term is computed we will compute the first one explicitly and simply state the remaining terms.
\begin{align}
    &i t\int_0^1 \parens{\frac{\partial}{\partial \alpha} e^{i s_1 (H+ \alpha G)t}} G e^{i(1-s_1)(H+\alpha G)t} ds_1 \rho e^{-i (H+\alpha G)t} \bigg|_{\alpha=0} \\
    &= (it)^2 \int_0^1 \int_0^1 e^{i s_1 s_2 (H+\alpha G)t} s_1 G e^{i s_1 (1-s_2) (H+\alpha G)t} ds_2 G e^{i(1-s_1) (H+\alpha G)t} ds_1 \rho e^{-i(H+\alpha G) t} \bigg|_{\alpha=0} \\
    &= -t^2 \int_0^1 \int_0^1 e^{i s_1 s_2 H t} G e^{-i s_1 s_2 H t} e^{i s_1 H t} G e^{-i s_1 H t} s_1 ds_1 ds_2 e^{i H t} \rho e^{-i H t} \\
    &= -t^2 \int_0^1 \int_0^1 G(s_1 s_2 t) G(s_1 t) s_1 ds_1 ds_2 \rho(t). 
\end{align}
The remaining terms we compute using a similar process, and are stated as
\begin{align}
    & -t^2 \int_0^1 \int_0^1 G(s_1 t) G((s_1 + s_2 - s_1 s_2) t) (1-s_1) ds_1 ds_2 \rho (t) \\
    & +t^2 \int_0^1 G(st) ds \rho(t) \int_0^1 G(st) ds \\
    & +t^2 \int_0^1 G(st) ds \rho(t) \int_0^1 G(st) ds \\
    & -t^2 \rho(t) \int_0^1 \int_0^1 G((1-s_1)t) G((1-s_1 s_2) t) s_1 ds_1 ds_2 \\
    & -t^2 \rho(t) \int_0^1 \int_0^1 G((1-s_1)t) G((1-s_1)(1 - s_2) t) (1-s_1) ds_1 ds_2.
\end{align}
For the last two terms we can make them look similar to the first two by redefining the integration variables. This leads to the simplified expression
\begin{align}
    \frac{\partial^2}{\partial \alpha^2} \Phi_G \bigg|_{\alpha = 0} &= 2 t^2 \int_0^1 G(st) ds \rho(t) \int_0^1 G(st) ds \label{eq:second_order_duhamel_one} \\
    &~ - t^2 \int_0^1 \int_0^1 \brackets{\rho(t) , G(s_1 t) G(s_1 s_2 t)}_+ s_1 ds_1 ds_2 \label{eq:second_order_duhamel_two}  \\
    &~ - t^2 \int_0^1 \int_0^1 \brackets{ \rho(t), G(s_1 t) G((s_1 + s_2 - s_1 s_2) t) }_+ (1-s_1) ds_1 ds_2 \label{eq:second_order_duhamel_three} 
\end{align}

We compute these explicitly term by term. Starting with Eq. \eqref{eq:second_order_duhamel_one} our goal is to write this term as a product of a phase contribution, an eigenvalue contribution, and a Haar integral. We decompose this utilizing the fact that our random matrices are sampled from distibutions that factor into a Haar eigenvector contribution $U_G$ and i.i.d eigenvalues $D$. We take the matrix elements:
\begin{align}
    2 t^2 \bra{i,j} \int_{0}^1 \int_0^1 e^{i H s_1 t} G e^{-iH s_1 t} e^{i H t} \rho e^{-i H t} e^{i H s_2 t} G e^{-iH s_2 t} ds_1 ds_2 \ket{k,l} \\
    \sum_{i',j',k',l'} 2t^2 \int_0^1 \int_0^1 e^{i E_{i,j} s_1 t} \bra{i,j} U_G \ket{i',j'} \bra{i',j'} D U_G^\dagger e^{i H (1-s_1) t} \rho e^{-i H (1-s_2) t} U_G D \ket{k',l'} \bra{k',l'} U_G^\dagger \ket{k,l} e^{-i E_{k,l} s_2 t} ds_1 ds_2 
\end{align}
Now we make the simplifying assumption that our input is a tensor product of a system thermal state and an environment thermal state, symbolically $\partfun_{sys}^{-1} e^{-\beta_{sys} H_{sys}} \otimes \partfun_{env}^{-1} e^{-\beta_{env}H_{env}}$. This allows us to write the state as diagonal in the Hamiltonian basis
\begin{align}
   2 t^2 \sum_{i',j',k',l', m,n} \int_0^1 \int_0^1 e^{i (E_{i,j} - E_{m,n}) s_1 t}  e^{i (E_{m,n} - E_{k,l})s_2 t} \bra{i',j'} D \ket{i',j'} \bra{k',l'} D \ket{k', l'} \bra{m,n} \rho \ket{m,n} \nonumber \\
   \times \bra{i,j} U_G \ket{i',j'} \bra{i',j'} U_G^\dagger \ket{m,n} \bra{m,n} U_G \ket{k',l'} \bra{k',l'} U_G^\dagger \ket{k,l}. \label{eq:second_order_duhamel_factored}
\end{align}
Now we use results from Weingarten calculus to compute the moments of the matrix elements of the Haar-distributed unitary
\begin{equation}
    \int dU_G \bra{i,j} U_G \ket{i',j'} \bra{m,n} U_G \ket{k',l'} \bra{m,n} \overline{U_G} \ket{i',j'} \bra{k,l} \overline{U_G} \ket{k',l'} = \frac{-\delta_{i,k} \delta_{j,l}}{\dim_{env\otimes sys} (\dim_{env \otimes sys}^2 - 1)}
\end{equation}

Now we turn our attention to the eigenvalue integral. We aren't going to use GUE anymore, instead we are just going to choose some values i.i.d from a similar distribution. The exact distribution is not critically important, for now we assume that the covariance is a multiple of the identity as $Cov(\lambda_{i,j}, \lambda_{k,l}) = \delta_{i,k} \delta_{j,l} \sigma^2$. This leads to
\begin{equation}
    \int \bra{i',j'} D \ket{i',j'} \bra{k',l'} D \ket{k',l'} ~dD = \delta_{i',k'} \delta_{j',l'} \sigma^2.
\end{equation}
Plugging these two expressions into Eq. \eqref{eq:second_order_duhamel_factored} we acheive
\begin{align}
    - 2 t^2 \sigma^2 \sum_{i',j',k',l',m,n} \int_0^1 \int_0^1 e^{i (E_{i,j} - E_{m,n}) s_1 t}  e^{i (E_{m,n} - E_{k,l})s_2 t} \bra{m,n} \rho \ket{m,n}  \frac{\delta_{i,k} \delta_{j,l}  \delta_{i',k'} \delta_{j',l'}}{\dim_{env \otimes sys} (\dim_{env \otimes sys}^2 - 1)} \\
    - \frac{2 t^2 \sigma^2 \delta_{i,k} \delta_{j,l}}{\dim_{env \otimes sys}^2 - 1} \sum_{m,n} \int_0^1 \int_0^1 e^{i (E_{i,j} - E_{m,n}) s_1 t}  e^{i (E_{m,n} - E_{k,l})s_2 t} \bra{m,n} \rho \ket{m,n} \\
    - \frac{2 t^2 \sigma^2 \delta_{i,k} \delta_{j,l}}{\dim_{env \otimes sys}^2 - 1} \sum_{m,n} \bra{m,n} \rho \ket{m,n} \frac{(e^{i(E_{i,j} - E_{m,n})t} - 1)}{(E_{i,j} - E_{m,n})t} \frac{(e^{i(E_{m,n} - E_{k,l})t} - 1)}{(E_{i,j} - E_{m,n})t} \\
    - \frac{4 \sigma^2 \delta_{i,k} \delta_{j,l}}{\dim_{env \otimes sys}^2 - 1} \sum_{m,n} \bra{m,n} \rho \ket{m,n} \frac{1 - \cos ((E_{i,j} - E_{m,n})t)}{(E_{i,j} - E_{m,n})^2}
\end{align}


Now we compute the second term, Eq. \eqref{eq:second_order_duhamel_two}. We avoid duplicating similar steps to the computation of the first computation and simply state the results (aka I need to write this up in an appendix.)
The second term, after writing everything in terms of sums over matrix elements, becomes
\begin{align}
    -t^2 \bra{i,j} \rho \ket{i,j} \sum_{i',j',k',l',m,n} \int_0^1 \int_0^1 e^{i(E_{i,j} - E_{m,n})s_1 t} e^{i(E_{m,n} - E_{k,l})s_1 s_2 t} s_1 ds_1 ds_2 \\
    \times \bra{i',j'} D \ket{i',j'} \bra{k',l'} D \ket{k',l'} \\
    \times \bra{i,j} U_G \ket{i',j'} \bra{m,n} U_G \ket{k',l'} \bra{m,n} \overline{U_G} \ket{i',j'} \bra{k,l} \overline{U_G} \ket{k',l'}
\end{align}
Plugging in similar results and integrating over the randomized interaction yields 
\begin{align}
    \sum_{i',j',k',l',m,n}\frac{\bra{i,j} \rho \ket{i,j} \sigma^2 }{E_{m,n} - E_{k,l}} \delta_{i',k'} \delta_{j',l'} \delta_{i,k} \delta_{j,l} 
\end{align}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Energy and Entropic concerns}
One requirement that our construction should satisfy is that a system in a thermal state should be invariant under contact with an environment at the same temperature. Formally, we would like that $\Phi \parens{\frac{e^{-\beta H_{sys}}}{\partfun_{sys}} \otimes \frac{e^{- \beta H_{env}}}{\partfun_{env}}} = \frac{e^{-\beta H_{sys}}}{\partfun_{sys}}$. Exact equality may be too strong to enforce, so we instead consider that the energy of the system remains unchanged after coupling with the environment. 

\begin{equation}
    \trace{H_{sys} \frac{e^{-\beta H_{sys}}}{\partfun_{sys}}} = \trace{H_{sys} \Phi \parens{\frac{e^{-\beta H_{sys}}}{\partfun_{sys}} \otimes \frac{e^{- \beta H_{env}}}{\partfun_{env}}}}.
\end{equation}
Now we look at the RHS in detail
\begin{align}
    \trace{H_{sys} \Phi \parens{\rho} } &= \trace{ H_{sys} \partrace{env}{\int e^{i \widetilde{H} t} \rho e^{-i \widetilde{H} t} dG}} \\
    &= \int \trace{H_{sys} \otimes \openone_{env} e^{i \widetilde{H} t} \rho e^{-i \widetilde{H} t} } dG \\
    &=  \trace{\int e^{- i (H + \alpha G) t} H_{sys} \otimes \openone_{env} e^{+ i (H + \alpha G) t} dG ~ \rho } 
\end{align}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Numerics}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Approximating $e^{i (H + \alpha G) t}$ evolution}


\section{Leftovers}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Simplifying $\Phi(\rho)$ with Perturbation Theory}
The goal is to use perturbation theory to write the output of the channel in terms of powers of the coupling strength $\alpha$. It remains to be seen if first order perturbation theory will be enough. We also are specifically interested when $\rho$ is a product state of thermal states, in other words $\rho_{PS} = \frac{e^{-\beta_1 H_1}}{\partfun_1} \otimes \frac{e^{-\beta_2 H_2}}{\partfun_2}$. We also denote the action of our channel with respect to a particular choice of $G$ as $\Phi_G$, which combined with linearity of partial traces gives $\Phi = \int dG \Phi_G$. 
\begin{align}
    \Phi_G(\rho_{PS}) &= \partrace{2}{e^{+i \widetilde{H} t} \rho_{PS} e^{-i \widetilde{H} t}} \\
    &= \sum_{k} \openone \otimes v_k^* \parens{\sum_{i, j} e^{i \widetilde{\eta}_{i, j} t} \widetilde{\Pi}_{i,j}} \rho_{PS} \parens{ \sum_{m, n} e^{i \widetilde{\eta}_{m, n} t} \widetilde{\Pi}_{m,n} }
\end{align}
Our next goal is to analyze $e^{i \widetilde{\eta}_{i,j} t} \widetilde{\Pi}_{i,j}$ using time-independent perturbation theory. Our goal is to write $e^{i \widetilde{\eta}_{i,j} t}$ as a power series in terms of $\alpha$, which is given by perturbation theory for $\widetilde{H} = H + \alpha G$. We first write the perturbation series for $\widetilde{\eta}$ as 
\begin{equation}
    \widetilde{\eta}_{i,j} = \eta_{i,j} + \alpha (u_i \otimes v_j)^* G (u_i \otimes v_j) + \alpha^2 \sum_{(i',j') \neq (i,j)}  \frac{\abs{(u_i \otimes v_j)^* G (u_{i'} \otimes v_{j'})}^{2}}{\eta_{i,j} - \eta_{i',j'}} + \bigo{\alpha^3}.
\end{equation}
To simplify the notation, we introduce the indexing $G(i,j,k,l) := (u_i \otimes v_j)^* G (u_k \otimes v_l)$. $G(i,j)$ without a second pair of indices denotes the diagonal matrix element $(u_i \otimes v_j)^* G (u_i \otimes v_j)$. The Taylor's Series for $e^{i \widetilde{\eta}_{i,j} t}$ is
\begin{align}
    e^{i \widetilde{\eta}_{i,j} t} &= e^{i \eta_{i,j} t} \\
    &\quad + \frac{\partial \widetilde{\eta}_{i,j}}{\partial \alpha} e^{i \widetilde{\eta}_{i,j}t} \bigg|_{\alpha = 0} i \alpha t \\
    &\quad + \frac{ i\alpha^2 t}{2!} \frac{\partial^2 \widetilde{\eta}_{i,j}}{\partial \alpha^2} e^{i \widetilde{\eta}_{i,j}t}\bigg|_{\alpha=0} \\
    &\quad - \frac{\alpha^2 t^2}{2!} \parens{\frac{\partial \widetilde{\eta}_{i,j}}{\partial \alpha}}^2 e^{i \widetilde{\eta}_{i,j} t} \bigg|_{\alpha=0} + \bigo{\alpha^3} .
\end{align}
These are rather straightforward to compute and plug in, yielding
\begin{equation}
    e^{i \widetilde{\eta}_{ij} t} = e^{i \eta_{ij} t}\parens{1 + i \alpha t G(i,j) - \frac{\alpha^2 t^2}{2} G(i,j)^2 + i \frac{\alpha^2 t}{2} \sum_{(i',j') \neq (i,j)}\frac{\abs{G(i',j',i,j)}^2}{\eta_{ij} - \eta_{i' j'}} + \bigo{\alpha^3}}.
\end{equation}
This is sloppy, need to be able to bound the $\bigo{\alpha^3}$ terms better. Also note that $G(i,j)$ is a real Gaussian variable, the realness is due to the Hermiticity constraint on $G$. 

The other quantity we need to compute a perturbation series for is $\widetilde{\Pi}_{ij}$. We first need to compute the perturbation series for the eigenvectors of $H$, which we do to second order
\begin{align}
    \widetilde{u_i \otimes v_j} &= u_i \otimes v_j \\
    &\quad + \alpha \sum_{(i',j') \neq (i,j)} u_{i'} \otimes v_{j'} \parens{  \frac{G(i,j,i',j')}{\eta_{i,j} - \eta_{i',j'}} } \\
    &\quad + \alpha^2 \sum_{(i',j') \neq (i,j)} u_{i'} \otimes v_{j'} \parens{ \sum_{(i'',j'') \neq (i,j)} \frac{G(i,j,i'',j'') G(i'',j'',i',j')}{(\eta_{i,j} - \eta_{i'',j''})(\eta_{i,j} - \eta_{i'',j''})} -  \frac{G(i,j,i,j) G(i,j,i',j')}{(\eta_{i,j} - \eta_{i',j'})^2}} \\
    &\quad + \bigo{\alpha^3}.
\end{align}
Now we need to compute the perturbed eigenspace projectors
\begin{align}
    \widetilde{\Pi}_{i,j} &= \Pi_{i,j} \\
    & \quad + \alpha \sum_{(i',j') \neq (i,j)} u_{i'} u_i^* \otimes v_{j'} v_j^* \parens{  \frac{G(i,j,i',j')}{\eta_{i,j} - \eta_{i',j'}} } + \sum_{(i',j') \neq (i,j)} u_i u_{i'}^* \otimes v_j v_{j'}^* \parens{  \frac{G(i,j,i',j')^*}{\eta_{i,j} - \eta_{i',j'}} } \\
    & \quad + \alpha^2 \sum_{(i',j') \neq (i,j)} u_{i'} u_i^* \otimes v_{j'} v_j^* \parens{ \sum_{(i'',j'') \neq (i,j)} \frac{G(i,j,i'',j'') G(i'',j'',i',j')}{(\eta_{i,j} - \eta_{i'',j''})(\eta_{i,j} - \eta_{i'',j''})} -  \frac{G(i,j,i,j) G(i,j,i',j')}{(\eta_{i,j} - \eta_{i',j'})^2}} \\
    & \quad + \alpha^2 \sum_{(i',j') \neq (i,j)} u_i u_{i'}^* \otimes v_j v_{j'}^* \parens{ \sum_{(i'',j'') \neq (i,j)} \frac{G(i,j,i'',j'')^* G(i'',j'',i',j')^*}{(\eta_{i,j} - \eta_{i'',j''})(\eta_{i,j} - \eta_{i'',j''})} -  \frac{G(i,j,i,j)^* G(i,j,i',j')^*}{(\eta_{i,j} - \eta_{i',j'})^2}} \\
    & \quad + \alpha^2 \sum_{(i',j') \neq (i,j)} \sum_{(i'',j'') \neq (i,j)} u_{i'}u_{i''}^* \otimes v_{j'} v_{j''}^* \frac{G(i,j,i',j') G(i,j,i'',j'')^*}{(\eta_{i,j} - \eta_{i',j'})(\eta_{i,j} - \eta_{i'',j''})} \\
    & \quad + \bigo{\alpha^3}.
\end{align}

This allows us to write the output of the channel $\Phi$ as a power series in $\alpha$. The expressions can become quite cumbersome, so we introduce the following notation:
\begin{align}
    M_{i,j,i',j'} &:=  u_{i'} u_i^* \otimes v_{j'} v_j^* \parens{  \frac{G(i,j,i',j')}{\eta_{i,j} - \eta_{i',j'}} } +  u_i u_{i'}^* \otimes v_j v_{j'}^* \parens{  \frac{G(i,j,i',j')^*}{\eta_{i,j} - \eta_{i',j'}} } \\
    N_{i,j,i',j'} &:= u_{i'} u_i^* \otimes v_{j'} v_j^* \parens{ \sum_{(i'',j'') \neq (i,j)} \frac{G(i,j,i'',j'') G(i'',j'',i',j')}{(\eta_{i,j} - \eta_{i'',j''})(\eta_{i,j} - \eta_{i'',j''})} -  \frac{G(i,j,i,j) G(i,j,i',j')}{(\eta_{i,j} - \eta_{i',j'})^2}} \\
    & \quad + \sum_{(i'',j'') \neq (i,j)} u_{i'}u_{i''}^* \otimes v_{j'} v_{j''}^* \frac{G(i,j,i',j') G(i,j,i'',j'')^*}{(\eta_{i,j} - \eta_{i',j'})(\eta_{i,j} - \eta_{i'',j''})}
\end{align}
which captures the first and second order corrections to the eigenspace projectors. We can then simplify
\begin{align}
    \widetilde{\Pi}_{i,j} &= \Pi_{i,j} + \alpha \sum_{(i',j') \neq (i,j)} M_{i,j,i',j'} + \alpha^2 \sum_{(i',j') \neq (i,j)} N_{i,j,i',j'} + \bigo{\alpha^3}
\end{align}
The second order corrections have 10 possible sources for terms, however many are hermitian conjugates of priors, so if herm. conj. appears it refers to the hermitian conjugate of the entire previous line.
\newpage
\begin{equation}
    e^{+i(H + \alpha G)t} \rho e^{-i (H + \alpha G) t}
\end{equation}
\begin{align}
\alpha^0 :& e^{+i H t} \rho e^{-i H t} \\
 \alpha^1 :& \sum_{i,j} e^{i\eta_{i,j}t} \parens{i t G(i,j) \Pi_{i,j} + \sum_{(i',j') \neq (i,j)} M_{i,j,i',j'}} \rho e^{- i H t} \\
 &+ \text{herm. conj.} \\
 \alpha^2 :& \sum_{i,j} i t G(i,j) e^{i \eta_{i,j}} \Pi_{i,j} \rho \sum_{k,l} (-i t) G(k,l)^* e^{-i \eta_{k,l}t} \Pi_{k,l} \\
 &+ \sum_{i,j} e^{i \eta_{i,j} t} \sum_{(i',j') \neq (i,j)} M_{i,j,i',j'} \rho \sum_{k,l} (-i t) G(k,l) e^{-i \eta_{k,l} t} \Pi_{k,l} \\
 &+ \text{herm. conj.} \\
 &+ \sum_{i,j} e^{i \eta_{i,j} t} \sum_{(i',j') \neq (i,j)} M_{i,j,i',j'} \rho \sum_{k,l} e^{-i \eta_{k,l} t} \sum_{(k',l') \neq (k,l)} M_{k,l,k',l'}\\
 &+  \sum_{i,j} e^{i \eta_{i,j} t} \parens{- \frac{t^2 G(i,j)^2}{2} + i \frac{t}{2} \sum_{(i',j') \neq (i,j)} \frac{\abs{G(i,j,i',j')}^2}{\eta_{i,j} - \eta_{i',j'}} } \rho e^{- i H t} \\
 &+ \text{herm. conj.} \\
 &+ \sum_{i,j} e^{i \eta_{i,j} t} \sum_{(i',j') \neq (i,j)} N_{i,j,i',j'} \rho e^{-i H t} \\
 &+ \text{herm. conj.} \\
 &+ \sum_{i,j} i t G(i,j) e^{i \eta_{i,j} t} \sum_{(i',j') \neq (i,j)} M_{i,j,i',j'} \rho e^{-i H t} \\
 &+ \text{herm. conj.}.
\end{align}

Two potential issues. 1) How can we normalize the output state? This may depend on how we approach the second. 2) How do we bound the remaining terms in the perturbation series? Are there any dumb bounds I can work out? 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Simplifying $\Phi(\rho)$ with Trotter}
The idea here is to try and see what very short time evolution does to our channel. At the very least this might give some intuition as to what is happening?
\begin{align}
    \Phi_G(\rho_{PS}) &= \partrace{2}{e^{+i\widetilde{H}t} \rho_{PS} e^{-i \widetilde{H} t}} \\
    &= \partrace{2}{\parens{e^{i G \alpha t} e^{i H t} + \bigo{t^2}} \rho_{PS} \parens{e^{-iHt} e^{-i G \alpha t} + \bigo{t^2}}} \\
    &= \partrace{2}{e^{i G \alpha t} \rho_{PS} e^{-i G \alpha t}} + \bigo{t^2} 
\end{align}

\section{Energy and Entropic concerns}
One requirement that our construction should satisfy is that a system in a thermal state should be invariant under contact with an environment at the same temperature. Formally, we would like that $\Phi \parens{\frac{e^{-\beta H_{sys}}}{\partfun_{sys}} \otimes \frac{e^{- \beta H_{env}}}{\partfun_{env}}} = \frac{e^{-\beta H_{sys}}}{\partfun_{sys}}$. Exact equality may be too strong to enforce, so we instead consider that the energy of the system remains unchanged after coupling with the environment. 

\begin{equation}
    \trace{H_{sys} \frac{e^{-\beta H_{sys}}}{\partfun_{sys}}} = \trace{H_{sys} \Phi \parens{\frac{e^{-\beta H_{sys}}}{\partfun_{sys}} \otimes \frac{e^{- \beta H_{env}}}{\partfun_{env}}}}.
\end{equation}
Now we look at the RHS in detail
\begin{align}
    \trace{H_{sys} \Phi \parens{\rho} } &= \trace{ H_{sys} \partrace{env}{\int e^{i \widetilde{H} t} \rho e^{-i \widetilde{H} t} dG}} \\
    &= \int \trace{H_{sys} \otimes \openone_{env} e^{i \widetilde{H} t} \rho e^{-i \widetilde{H} t} } dG \\
    &=  \trace{\int e^{- i (H + \alpha G) t} H_{sys} \otimes \openone_{env} e^{+ i (H + \alpha G) t} dG ~ \rho }
\end{align}

 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Approximating $e^{i (H + \alpha G) t}$ evolution}

\bibliographystyle{unsrt}
\bibliography{bib}

\end{document}
